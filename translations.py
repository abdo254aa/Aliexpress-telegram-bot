TRANSLATIONS = {
    'choose_language': {
        'en': "Please choose your preferred language:",
        'ar': "يرجى اختيار لغتك المفضلة:",
    },
    'language_set': {
        'en': "Language set to English. 🇬🇧",
        'ar': "تم ضبط اللغة على العربية. 🇸🇦",
    },
    'welcome': {
        'en': ("👋 Welcome to the AliExpress Discount Bot! 🛍️\n\n"
               "🔍 <b>How to use:</b>\n"
               "1️⃣ Copy an AliExpress product link 📋\n"
               "2️⃣ Send the link here 📤\n"
               "3️⃣ Get affiliate links back ✨\n\n"
               "🔗 Supports regular & short links.\n"
               "🚀 Send a link to start! 🎁"),
        'ar': ("👋 مرحبًا بك في بوت خصومات AliExpress! 🛍️\n\n"
               "🔍 <b>كيفية الاستخدام:</b>\n"
               "1️⃣ انسخ رابط منتج من AliExpress 📋\n"
               "2️⃣ أرسل الرابط هنا 📤\n"
               "3️⃣ احصل على روابط الأفلييت ✨\n\n"
               "🔗 يدعم الروابط العادية والقصيرة.\n"
               "🚀 أرسل رابطًا للبدء! 🎁"),
    },
    'error_no_link': {
        'en': "❌ No AliExpress links found. Please send a valid AliExpress product link.",
        'ar': "❌ لم يتم العثور على روابط AliExpress. يرجى إرسال رابط منتج AliExpress صالح.",
    },
    'error_no_valid_links': {
        'en': "❌ We couldn't find any valid AliExpress product links in your message.",
        'ar': "❌ لم نتمكن من العثور على أي روابط منتجات AliExpress صالحة في رسالتك.",
    },
    'processing_multiple': {
        'en': "⏳ Processing {count} AliExpress products. Please wait...",
        'ar': "⏳ جاري معالجة {count} منتجات AliExpress. يرجى الانتظار...",
    },
    'prompt_send_link': {
        'en': "Please send an AliExpress product link to generate affiliate links.",
        'ar': "يرجى إرسال رابط منتج AliExpress لإنشاء روابط أفلييت.",
    },
    'error_processing_product': {
        'en': "An unexpected error occurred while processing product ID {product_id}. Sorry!",
        'ar': "حدث خطأ غير متوقع أثناء معالجة معرف المنتج {product_id}. عذراً!",
    },
    'error_api_or_scrape': {
        'en': "Could not retrieve data for product ID {product_id}.",
        'ar': "تعذر استرداد البيانات لمعرف المنتج {product_id}.",
    },
    'product_details_unavailable': {
        'en': "❌ <b>Product details unavailable</b>",
        'ar': "❌ <b>تفاصيل المنتج غير متوفرة</b>",
    },
    'price_label': {
        'en': "💰 <b>Price:</b>",
        'ar': "💰 <b>السعر:</b>",
    },
    'price_unavailable_scraped': {
        'en': "💰 <b>Price:</b> Unavailable (Scraped)",
        'ar': "💰 <b>السعر:</b> غير متوفر (تم السحب)",
    },
    'special_offers_label': {
        'en': "🎁 <b>Special Offers:</b>",
        'ar': "🎁 <b>عروض خاصة:</b>",
    },
    'get_discount': {
        'en': "Get Discount",
        'ar': "احصل على الخصم",
    },
    'not_available': {
        'en': "❌ Not Available",
        'ar': "❌ غير متوفر",
    },
    'no_offers_found': {
        'en': "We couldn't find an offer for this product.",
        'ar': "لم نتمكن من العثور على عرض لهذا المنتج.",
    },
    'follow_us_label': {
        'en': "🔔 <b>Follow Us:</b>",
        'ar': "🔔 <b>تابعنا:</b>",
    },
    'telegram_label': {
        'en': "📱 Telegram:",
        'ar': "📱 تيليجرام:",
    },
    'github_label': {
        'en': "💻 GitHub:",
        'ar': "💻 جيت هاب:",
    },
    'discord_label': {
        'en': "🤝 Discord:",
        'ar': "🤝 ديسكورد:",
    },
    'discord_cta': {
       'en': "Join Our Community",
       'ar': "انضم لمجتمعنا"
    },
    'footer_text': {
        'en': "<i>By RizoZ - Deals Bot</i>",
        'ar': "<i>بواسطة RizoZ - بوت الصفقات</i>",
    },
    'choice_day_button': { 'en': "🎯 Choice Day", 'ar': "🎯 يوم الاختيار" },
    'best_deals_button': { 'en': "🔥 Best Deals", 'ar': "🔥 أفضل الصفقات" },
    'github_button': { 'en': "💻 GitHub", 'ar': "💻 جيت هاب" },
    'discord_button': { 'en': "🎮 Discord", 'ar': "🎮 ديسكورد" },
    'channel_button': { 'en': "📱 Channel", 'ar': "📱 القناة" },
    'support_button': { 'en': "☕ Support Me", 'ar': "☕ ادعمني" },
    # --- Offer Names ---
    'offer_coin': {'en': "🪙 Coin", 'ar': "🪙 عملة"},
    'offer_super': {'en': "🔥 Super Deals", 'ar': "🔥 صفقات سوبر"},
    'offer_limited': {'en': "⏳ Limited Offers", 'ar': "⏳ عروض محدودة"},
    'offer_bigsave': {'en': "💰 Big Save", 'ar': "💰 توفير كبير"},
    'error_displaying_product': {
        'en': "⚠️ Error displaying product {product_id}. Please try again or check the logs.",
        'ar': "⚠️ خطأ في عرض المنتج {product_id}. يرجى المحاولة مرة أخرى أو التحقق من السجلات.",
    },
    'error_fallback_failed': {
         'en': "Failed to send fallback error message for product {product_id} to chat {chat_id}",
         'ar': "فشل إرسال رسالة الخطأ البديلة للمنتج {product_id} إلى الدردشة {chat_id}"
    }
}

# Add offer names to OFFER_PARAMS using translations
OFFER_PARAMS_LANG = {
    "coin": {"key": "offer_coin", "params": {"sourceType": "620%26channel=coin"}},
    "super": {"key": "offer_super", "params": {"sourceType": "562", "channel": "sd"}},
    "limited": {"key": "offer_limited", "params": {"sourceType": "561", "channel": "limitedoffers"}},
    "bigsave": {"key": "offer_bigsave", "params": {"sourceType": "680", "channel": "bigSave"}},
}
OFFER_ORDER = ["coin", "super", "limited", "bigsave"]


DEFAULT_LANG = 'en'

def get_text(key: str, lang_code: str | None, **kwargs) -> str:
    """Retrieves translated text for a given key and language code."""
    if lang_code is None:
        lang_code = DEFAULT_LANG
    try:
        # Attempt to get the text for the specified language
        text = TRANSLATIONS[key][lang_code]
    except KeyError:
        try:
            # Fallback to default language if the key or lang_code is missing
            text = TRANSLATIONS[key][DEFAULT_LANG]
            # Log a warning if the language was missing, but the key exists
            if lang_code != DEFAULT_LANG and key in TRANSLATIONS and lang_code not in TRANSLATIONS[key]:
                 print(f"Warning: Language '{lang_code}' not found for key '{key}'. Falling back to '{DEFAULT_LANG}'.") # Use logger in real app
            # Log an error if the key itself is missing
            elif key not in TRANSLATIONS:
                 print(f"Error: Translation key '{key}' not found.") # Use logger in real app
                 text = key # Return the key itself as a fallback
        except KeyError:
            # Fallback if the key doesn't exist even in the default language
            print(f"Error: Translation key '{key}' not found in default language '{DEFAULT_LANG}'.") # Use logger in real app
            text = key # Return the key itself

    # Format the string with any provided keyword arguments
    try:
        return text.format(**kwargs)
    except KeyError as e:
        print(f"Error: Missing formatting key {e} for text key '{key}' in language '{lang_code}'. Text: '{text}'") # Use logger in real app
        return text # Return unformatted text on error

def get_offer_name(offer_key: str, lang_code: str | None) -> str:
    """Gets the translated name for an offer."""
    if offer_key in OFFER_PARAMS_LANG:
        translation_key = OFFER_PARAMS_LANG[offer_key]['key']
        return get_text(translation_key, lang_code)
    return offer_key # Fallback to the key name

# --- END OF FILE translations.py ---# --- END OF FILE translations.py --dd
